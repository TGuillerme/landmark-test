---
title: "Heat map plot of changes"
author: "Thomas Guillerme"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_width: 12
    fig_height: 6
---

Some fancy plots for the maximum landmark variation.

## Plots 

### Loading the functions

```{r, message = FALSE, warning = FALSE}
## Loading the libraries (and installing if necessary)
if(!require(devtools)) install.packages("devtools")
if(!require(geomorph)) install.packages("geomorph")
if(!require(dispRity)) install_github("TGuillerme/dispRity")
if(!require(landmarktest)) install_github("TGuillerme/landmark-test")
set.seed(1)
```


### Loading the data

```{r}
## Loading a dataset
load("../Data/Processed/wombat_ursinus.Rda")

## Selecting a partition
cranium <- land_data$cranium
```

The "maximum" and "minimum" specimen:

```{r}
## Procrustes variation ranges
variation <- variation.range(cranium$procrustes, return.ID = TRUE, CI = 0.5)
specimens_min_max <- variation$min.max
procrustes_var <- variation$range[,1]
```

```{r, eval = FALSE}
gridPar = gridPar(pt.bg = "white", pt.size = 0.5)
open3d()
plotRefToTarget.heat(cranium$procruste$coords[, , specimens_min_max[2]],
                     cranium$procruste$coords[, , specimens_min_max[1]],
                     col = heat.colors, pt.size = 1, col.val = procrustes_var,
                     plotRefToTarget.args = list(mag = 1))
```


Same but with the PCA

```{r}
## Procrustes variation ranges
variation_all_PC_axis <- variation.range(cranium$procrustes, return.ID = TRUE, CI = 0.5, ordination = TRUE, axis = 1)
specimens_min_max <- variation_all_PC_axis$min.max
procrustes_var <- variation_all_PC_axis$range[,1]
```

```{r, eval = FALSE}
gridPar = gridPar(pt.bg = "white", pt.size = 0.5)
open3d()
plotRefToTarget.heat(cranium$procruste$coords[, , specimens_min_max[2]],
                     cranium$procruste$coords[, , specimens_min_max[1]],
                     col = heat.colors, pt.size = 1, col.val = procrustes_var,
                     plotRefToTarget.args = list(mag = 1))
```
