---
title: "Heat map plot of changes"
author: "Thomas Guillerme"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_width: 12
    fig_height: 6
---

Some fancy plots for the maximum landmark variation.

## Plots 

### Loading the functions

```{r, message = FALSE, warning = FALSE}
## Loading the libraries (and installing if necessary)
if(!require(devtools)) install.packages("devtools"); library(devtools)
if(!require(geomorph)) install.packages("geomorph"); library(geomorph)
if(!require(dispRity)) install.packages("dispRity"); library(dispRity)
if(!require(landmarktest)) install_github("TGuillerme/landmark-test"); library(landmarktest)
set.seed(42)
```


### Loading the data

```{r}
## Loading a dataset

#loading the below loads objects called land_data, NOT "wombat"
load("../Data/Processed/wombat.Rda")
AllWombats<-land_data
load("../Data/Processed/wombat_lasiorhinus.Rda")
HN<-land_data
load("../Data/Processed/wombat_krefftii.Rda")
NHNW<-land_data
load("../Data/Processed/wombat_latifrons.Rda")
SHNW<-land_data
load("../Data/Processed/wombat_ursinus.Rda")
CW<-land_data
source("../Functions/utilities.R")

```

The "maximum" and "minimum" specimen:

```{r}
## Procrustes variation ranges
cranium=SHNW$cranium
variation <- variation.range(cranium$procrustes, return.ID = TRUE, CI = 0.5)
specimens_min_max <- variation$min.max
procrustes_var <- variation$range[,1]
```

```{r, eval = FALSE}
gridPar = gridPar(pt.bg = "white", pt.size = 0.5)
open3d()
plotRefToTarget.heat(cranium$procruste$coords[, , specimens_min_max[2]],
                     cranium$procruste$coords[, , specimens_min_max[1]],
                     col = heat.colors, pt.size = 0.3, col.val = procrustes_var,
                     plotRefToTarget.args = list(mag = 1))
```


#Doing this using hypothetical PC min/max landmarks. 

```{r, eval = FALSE}


heatplot.PCs(AllWombats$cranium, minfirst=FALSE, 1 )
heatplot.PCs(HN$cranium, minfirst=TRUE ,1 )
heatplot.PCs(CW$cranium, minfirst=TRUE,1)
heatplot.PCs(SHNW$cranium, minfirst=TRUE,1)
heatplot.PCs(NHNW$cranium, minfirst=TRUE,1)


heatplot.PCs(AllWombats$mandible, minfirst=FALSE, 1)
heatplot.PCs(HN$mandible, minfirst=TRUE, 1 )
heatplot.PCs(CW$mandible, minfirst=FALSE,1)
heatplot.PCs(SHNW$mandible, minfirst=TRUE,1)
heatplot.PCs(NHNW$mandible, minfirst=TRUE, 1)



```

