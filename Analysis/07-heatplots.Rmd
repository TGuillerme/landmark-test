---
title: "Heat map plot of changes"
author: "Thomas Guillerme"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_width: 12
    fig_height: 6
---

Some fancy plots for the maximum landmark variation.

## Plots 

### Loading the functions

```{r, message = FALSE, warning = FALSE}
## Loading the libraries (and installing if necessary)
if(!require(devtools)) install.packages("devtools")
if(!require(knitr)) install.packages("knitr")
if(!require(geomorph)) install.packages("geomorph")
if(!require(RCurl)) install.packages("RCurl")
if(!require(zoo)) install.packages("zoo")
if(!require(dispRity)) install_github("dispRity")
## Loading the function
source("../Functions/coordinates.difference.R")
source("../Functions/coordinates.area.R")
source("../Functions/variation.range.R")
source("../Functions/sanitizing.R")
source("../Functions/plotRefToTarget.heat.R")
set.seed(1)
```

### Loading the data

```{r}
## Loading a dataset
load("../Data/Processed/wombat_ursinus.Rda")

## Selecting a partition
cranium <- land_data$cranium
```

The "maximum" and "minimum" specimen:

```{r}
## Procrustes variation ranges
variation <- variation.range(cranium$procruste, return.ID = TRUE)
specimens_min_max <- variation$min.max
procrustes_var <- variation$range[,1]
```

```{r, eval = FALSE}
gridPar = gridPar(pt.bg = "white", pt.size = 0.5)
open3d()
plotRefToTarget.heat(cranium$procruste$coords[, , specimens_min_max[2]],
                     cranium$procruste$coords[, , specimens_min_max[1]],
                     method = "vector", mag = 2,
                     col.vector = heat.colors, col.points = heat.colors,
                     val.vector = procrustes_var, val.points = procrustes_var)
```
