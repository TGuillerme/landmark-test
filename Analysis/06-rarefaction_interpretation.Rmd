---
title: "Landmark region difference"
author: "Thomas Guillerme"
bibliography: references.bib
date: "`r Sys.Date()`"
output:
  html_document:
    fig_width: 12
    fig_height: 6
---

```{r, message = FALSE, warning = FALSE}
if(!require(knitr)) install.packages("knitr")
source("../Functions/utilities.R")
```

## Rarefied results summary


```{r, echo = FALSE}
get.token <- function(p) {
    if(p > 0.05) {
        return("")
    }
    if(p < 0.05 && p > 0.01) {
        return(".")
    }
    if(p < 0.01 && p > 0.001) {
        return("*")
    }
    if(p < 0.001) {
        return("**")
    }
}

species <- c("Wombat", "Wombat_krefftii", "Wombat_latifrons", "Wombat_ursinus")
datasets <- c("cranium", "mandible")

results_table <- data.frame(matrix(NA, ncol = length(species)*3, nrow = 11))

for(sp in 1:length(species)) {

    for(ds in 1:length(datasets)) {

        ## Extract the results
        load(paste0("../Data/Results/", species[sp], "_", datasets[ds], "_rarefied.Rda"))

        ## Summarise the results
        difference <- make.table(results$difference, correction = "bonferroni")
        overlap <- make.table(results$overlaps, correction = "bonferroni")

        ## Fill the table
        if(ds == 1) {
            ## Cranium
            results_table[1:5, 1+(3*(sp-1))] <- difference[,2]
            results_table[1:5, 2+(3*(sp-1))] <- sapply(difference[,6], get.token)
            results_table[1:5, 3+(3*(sp-1))] <- sapply(overlap[,6], get.token)
            ## Make the differences to be 0 if non-signif
        } else {
            ## Mandible
            results_table[6:11, 1+(3*(sp-1))] <- difference[,2]
            results_table[6:11, 2+(3*(sp-1))] <- sapply(difference[,6], get.token)
            results_table[6:11, 3+(3*(sp-1))] <- sapply(overlap[,6], get.token)
        }
    }
}

## Colnames sequence
sequence <- seq(from = 1, to =11, by = 3)

## Renaming the columns
colnames(results_table)[sequence] <- species
colnames(results_table)[sequence+1] <- "diff"
colnames(results_table)[sequence+2] <- "over"

## Renaming the rows
rownames(results_table) <- c(paste0(datasets[1], 1:5), paste0(datasets[2], 1:6))


##
kable(results_table, digits = 4)

```
