---
title: "Landmark region difference"
author: "Thomas Guillerme"
bibliography: references.bib
date: "`r Sys.Date()`"
output:
  html_document:
    fig_width: 12
    fig_height: 6
---

```{r, message = FALSE, warning = FALSE}
## Loading the libraries (and installing if necessary)
if(!require(devtools)) install.packages("devtools")
if(!require(knitr)) install.packages("knitr")
if(!require(xtable)) install.packages("knitr")
if(!require(geomorph)) install.packages("geomorph")
if(!require(dispRity)) install_github("TGuillerme/dispRity")
if(!require(landmarktest)) install_github("TGuillerme/landmark-test")
source("../Functions/utilities.R")
set.seed(42)
```















# Within species

## Wombat ursinus

### Cranium

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_ursinus"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_ursinus"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```














## Wombat krefftii

### Cranium

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_krefftii"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_krefftii"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```














## Wombat latifrons

### Cranium

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_latifrons"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_latifrons"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```














# Between species

## Cranium

```{r, echo = FALSE, message = FALSE}
species <- "Wombat"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```

## Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE)
save(results, file = paste0("../Data/Results/", species, "_", dataset, ".Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", results$species)
caption_over <- paste0("Results of the overlap probability random test for the ", results$ataset, " of ", results$species)

## Size differences
kable(make.table(results$differences, "bonferroni"), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni"), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_difference"))
make.xtable(results$overlaps, "bonferroni", digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0(species, "_", dataset, "_overlaps"))
```

### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps.pdf"))
```

