---
title: "Landmark region difference"
author: "Thomas Guillerme"
bibliography: references.bib
date: "`r Sys.Date()`"
output:
  html_document:
    fig_width: 12
    fig_height: 6
---

```{r, message = FALSE, warning = FALSE}
## Loading the libraries (and installing if necessary)
if(!require(devtools)) install.packages("devtools")
if(!require(knitr)) install.packages("knitr")
if(!require(xtable)) install.packages("knitr")
if(!require(geomorph)) install.packages("geomorph")
if(!require(dispRity)) install_github("TGuillerme/dispRity")
if(!require(landmarktest)) install_github("TGuillerme/landmark-test")
source("../Functions/utilities.R")
set.seed(42)
```





##### Note for changing the confidence interval values

Search and replace `CI = 0.95` and `CI95` by respectively `CI = 1` and `CI100` for switching from the 95% confidence interval to the 100%.




# Between species

## All species

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- 1
species <- "Wombat"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```














## Lasiorhinus genus

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_lasiorhinus"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
#load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_lasiorhinus"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
#load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```












# Within species

## Wombat krefftii

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_krefftii"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_krefftii"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```














## Wombat latifrons

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_latifrons"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_latifrons"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```











## Wombat ursinus

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_ursinus"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_ursinus"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, combine.land = FALSE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))
load(file = paste0("../Data/Results/", species, "_", dataset, "_CI100.Rda"))

caption_diff <- paste0("Results of the area difference random test for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni")
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni")
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_CI100.pdf"))
```






# Rarefied analysis










## Between species

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- 1
species <- "Wombat"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```














## Lasiorhinus genus

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_lasiorhinus"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
#load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_lasiorhinus"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
#load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```










# Within species

## Wombat krefftii

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_krefftii"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_krefftii"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```














## Wombat latifrons

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_latifrons"
dataset <- "cranium"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_latifrons"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```















## Wombat ursinus

### Cranium

```{r, echo = FALSE, message = FALSE}
counter <- counter + 1
species <- "Wombat_ursinus"
dataset <- "cranium"

results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```

### Mandible

```{r, echo = FALSE, message = FALSE}
species <- "Wombat_ursinus"
dataset <- "mandible"
results <- pipeline.test(species, dataset, "../Data/Processed/", verbose = TRUE, rarefaction = TRUE, CI = 1)
save(results, file = paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Results/", species, "_", dataset, "rarefied_CI100.Rda"))
load(paste0("../Data/Processed/", species, ".Rda"))
results$rarefaction <- min(table(land_data[[dataset]]$landmarkgroups[,2]))

caption_diff <- paste0("Results of the area difference random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))
caption_over <- paste0("Results of the overlap probability random test (rarefied - ", results$rarefaction, ") for the ", results$dataset, " of ", translate.name(results$species))

 ## Get arguments for the partitions naming
 part_args <- get.partition.args(dataset)
 
 ## Size differences
kable(make.table(results$differences, "bonferroni", partition.args = part_args), digits = 5, caption = caption_diff)

## Probability of overlap
kable(make.table(results$overlaps, "bonferroni", partition.args = part_args), digits = 5, caption = caption_over)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
## xtables for pub
make.xtable(results$differences, "bonferroni", partition.args = part_args, digits = 3, caption = caption_diff, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_difference_rarefied_CI100"))
make.xtable(results$overlaps, "bonferroni", partition.args = part_args, digits = 3, caption = caption_over, path = "../Manuscript/Tables/", label = paste0("0", counter, "_", translate.name(species), "_", dataset, "_overlaps_rarefied_CI100"))
```

#### Area difference
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

#### Bhattacharyya Coefficient
```{r, fig.width = 10, fig.height = 15, echo = FALSE, message = FALSE}
## Plot the size differences
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction)
```

```{r, eval = TRUE, echo = FALSE, print = FALSE, results = 'hide'}
make.plots(results$differences, type = "area difference", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_difference_rarefied_CI100.pdf"))
make.plots(results$overlaps, type = "Bhattacharyya Coefficient", add.p = TRUE, correction = "bonferroni", rarefaction = TRUE, rare.level = results$rarefaction, path = paste0("../Manuscript/Figures/", species, "_", dataset, "_overlaps_rarefied_CI100.pdf"))
```



